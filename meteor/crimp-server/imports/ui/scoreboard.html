<template name="scoreboard">
  <section class="scoreboard">
    <h1>Live Scores</h1>
    <!-- Title and dropdown selection for category -->
    {{> scoreboard_header}}

    <!-- Scores of Climbers in chosen category -->
    {{> scoreboard_climbers}}
  </section>
</template>

<template name="scoreboard_header">
  <div class="scoreboard-header column row">
    <ul id="scoreboard-selectCategory" class="dropdown menu" data-dropdown-menu>
      <li>
        <a href="#" class="scoreboard-selectCategory-display">
          <i class="material-icons">arrow_drop_down_circle</i>{{viewCategory.category_name}}
          {{#if viewCategory.isOngoing}}
            <span class="scoreboard-categoryOngoing">Live now!</span>
          {{/if}}
        </a>
        <ul class="menu">
          {{#each category in categories}}
            <li data-timeStart="{{category.time_start}}"
                data-timeEnd="{{category.time_end}}"
                data-category="{{category._id}}">
              <a href="#">
                {{category.category_name}}
                {{#if category.isOngoing}}
                  <span class="scoreboard-categoryOngoing">Live now!</span>
                {{/if}}
              </a>
            </li>
          {{/each}}
        </ul>
      </li>
    </ul>

    <div class="scoreboard-categoryDetails">
      {{#if viewCategory.is_score_finalized}}
        Scores for this category are finalized
      {{/if}}
    </div>
  </div>
</template>

<template name="scoreboard_climbers">
  {{#if climbers}}
    <ul class="scoreboard-climbers">
      {{#each climber in climbers}}
        <li class="climber" id="climber-{{climber.marker_id}}">
          <div class="climber-row clearfix">
            <div class="climber-details">
              <span class="climber-rank"><b>#</b>{{climber.rank}}</span>
              <span class="climber-name">
                <b>{{climber.marker_id}}</b> {{climber.climber_name}}
              </span>
            </div>

            <div class="climber-scoretotal">
              {{> Template.dynamic
                    template=climber.tabulatedScore.system
                    data=climber.tabulatedScore}}
            </div>
          </div>

          <div class="climber-row">
            <!-- TODO: Template to show only top 6 scoring-->
            <div class="{{#if climber.needScrolling}}table-scroll{{/if}}">
              <table class="climber-scores">
                <tr>
                  {{#each score in climber.scores}}
                    <td data-route="{{route_id}}">
                      {{score.calculatedScore.displayString}}
                    </td>
                  {{/each}}
                </tr>
              </table>
            </div>
          </div>
        </li>
      {{/each}}
    </ul>
  {{else}}
    <div class="scoreboard-climbers">
      {{> loader}}
    </div>
  {{/if}}
</template>
